<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>Encodage et décodage par matrice</title>
<link href="../style.css" rel="stylesheet" type="text/css"/>
<link href="enc-dec.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="header">
<h1>Encodage et décodage par matrice</h1>
</div>
<div id="content">
<fieldset style="width: 320px;">
<legend id="enc-settings">Settings</legend>
<ul>
<li>
<label for="enc-word-length" id="enc-word-length-label">Word length:</label>
<select id="enc-word-length" class="select">
<option value="2">4 letters</option>
<option value="3">9 letters</option>
</select>
</li>
<li>
<label for="enc-word" id="enc-word-label">Word:</label>
<input type="text" id="enc-word" value="" class="text" style="text-transform: uppercase;" maxlength="9" />
</li>
<li>
<label id="enc-key-label">Key:</label>
<div id="enc-key"></div>
</li>
<li>
<label id="enc-key4x4-label">Message:</label>
<div id="enc-message"></div>
</li>
<li class="controls">
<button id="enc-encode" class="button">Encode</button>
<button id="enc-decode" class="button">Decode</button>
<button id="enc-generate" class="button">Generate Key</button>
</li>
</fieldset>
<div id="game"></div>
</div>
<div id="footer">
<p>2011 <a href="mailto:francislr@gmail.com" title="Envoyer un courriel">Francis Lavoie-Renaud</a></p>
</div>
<script src="enc-dec.js" type="text/javascript" charset="UTF-8">
</script>
<script>
//<![CDATA[
Game = null;

UI_LOCALIZATION = {
  "en": {
  },
  "fr": {
  }
};
word_length_select = document.getElementById("enc-word-length");
word_text = document.getElementById("enc-word");
encode_button = document.getElementById("enc-encode");
decode_button = document.getElementById("enc-decode");

function apply_translation(lang) {
  if (!UI_LOCALIZATION[lang]) {
    return ;
  }
  for (key in UI_LOCALIZATION[lang]) {
    var element = document.getElementById(key);
    if (!element) {
      continue ;
    }
    var message = UI_LOCALIZATION[lang][key];
    var tag_name = new String(element.tagName);
    if (tag_name.toLowerCase() == "select") {
      for (var i = 0; i < element.options.length; i++) {
        var option = element.options[i];
        var value = option.value;
        if (!message[value]) {
          continue ;
        }
        option.text = message[value];
      }
    }
    else {
      element.innerHTML = message;
    }
  }
}

function getSelectValue(element) {
  try {
    return element.options[element.selectedIndex].value;
  }
  catch (e) {
    return "";
  }
}

function setSelectItem(element, value) {
  for (var i = 0; i < element.options.length; i++) {
    if (element.options[i].value == value) {
      element.selectedIndex = i;
      break ;
    }
  }
}

language = "fr";

function update_game() {
  var word_length = getSelectValue(word_length_select),
      word = word_text.value;
  word_length = parseInt(word_length);
  if (!Game) {
    Game = new enc.Game(language);
  }
  Game.setMatrixDimension(word_length);
  Game.setWord(word);
  apply_translation(language);
}

function encode_word() {
  if (!Game) {
    return ;
  }
  update_game();
  Game.encode();
}

function decode_word() {
  if (!Game) {
    return ;
  }
  update_game();
  Game.decode();
}
update_game();
word_length_select.onchange = update_game;
encode_button.onclick = encode_word;
decode_button.onclick = decode_word;
window.onload = function () {
  var lang_code;
  try {
    if (navigator.language) {
      lang_code = navigator.language;
    }
    else if (navigator.systemLanguage) {
      lang_code = navigator.userLanguage;
    }
    else if (navigator.userLanguage) {
      lang_code = navigator.userLanguage;
    }
    if (lang_code) {
      lang_code = lang_code.substr(0, 2);
      setSelectItem(language_select, lang_code);
    }
  }
  catch (e) {
  }
  update_game();
};
//]]>
</script>
</body>
</html>